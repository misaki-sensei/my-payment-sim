<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>顧客アプリ</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="app-title">PayPay模擬アプリ</h1>
            <p class="shop-name">顧客向け</p>
            <p class="small-text">顧客ID: <span id="customer-id-display"></span></p>
        </header>

        <section class="card balance-section">
            <p class="balance-label">残高</p>
            <p class="balance">¥ <span id="balance-display">0</span></p>
        </section>

        <section id="main-actions-section" class="card action-section">
            <h2 class="section-title-small">アクション選択</h2>
            <button id="show-pay-section" class="pay-btn large-btn action-btn">
                <span class="icon">💳</span> 支払う
            </button>
            <button id="show-charge-section" class="charge-toggle-btn large-btn action-btn">
                <span class="icon">💰</span> チャージする
            </button>
        </section>

        <section id="pay-section" class="card qr-reader-section hidden">
            <h2 class="section-title">QRコード読み取り</h2>
            <p class="section-description">店舗のQRコードをスキャンしてください。</p>
            <div class="qr-camera-area">
                <video id="qr-camera-video" class="qr-camera-video"></video>
                <canvas id="qr-camera-canvas"></canvas>
                <div class="scan-line"></div>
                <p id="camera-status" class="camera-status">カメラ起動中...</p>
            </div>
            <p id="qr-instruction" class="qr-instruction">カメラをQRコードに向けてください。</p>
            <p id="read-amount-display" class="read-amount-display hidden">
                支払い金額: <span>¥ 0</span>
            </p>
            <button id="pay-button" class="pay-btn large-btn hidden">支払い実行</button>
            <button id="back-to-main-from-pay" class="toggle-btn large-btn">戻る</button>
        </section>

        <section id="charge-section" class="card charge-section hidden">
            <h2 class="section-title">チャージ</h2>
            <div class="input-group">
                <label for="charge-amount">チャージ金額 (円)</label>
                <input type="number" id="charge-amount" placeholder="金額を入力" value="1000">
            </div>
            <p id="predicted-balance-display" class="predicted-balance-display">
                チャージ後残高: <span>¥ 0</span>
            </p>
            <button id="charge-button" class="primary-btn large-btn">チャージ実行</button>
            <button id="back-to-main-from-charge" class="toggle-btn large-btn">戻る</button>
        </section>

        <section id="completion-section" class="card payment-completion-section hidden">
            <div id="payment-completion-card" class="completion-card hidden">
                <span class="completion-icon">✅</span>
                <p class="completion-message">支払い完了！</p>
                <p class="completed-amount">¥ <span id="completed-payment-amount"></span></p>
                <p class="thanks-message">ご利用ありがとうございました。</p>
                <p class="shop-id-display">取引店舗: <span id="payment-completed-shop-id"></span></p>
                <p class="small-text">取引ID: <span id="payment-completed-transaction-id"></span></p>
            </div>
            <div id="charge-completion-card" class="completion-card charge-completion-section hidden">
                <span class="completion-icon">💰</span>
                <p class="completion-message">チャージ完了！</p>
                <p class="completed-amount">¥ <span id="completed-charge-amount"></span></p>
                <p class="thanks-message">残高がチャージされました。</p>
            </div>
            <button id="back-to-main-from-completion" class="primary-btn large-btn">メインに戻る</button>
        </section>


        <section id="history-section" class="card history-section">
            <h2 class="section-title">取引履歴</h2>
            <ul id="customer-history-list">
                </ul>
            <button id="clear-customer-history" class="secondary-btn">履歴と残高をリセット</button>
        </section>
    </div>

    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="customer_script.js"></script>
</body>
</html>
